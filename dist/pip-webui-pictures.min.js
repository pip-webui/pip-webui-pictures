!function(){"use strict";angular.module("pipPictures",["pipAddImage","pipAvatar","pipAvatarEdit","pipPicture","pipPictureEdit","pipCollage","pipPictureListEdit","pipCameraDialog","pipPictureUrlDialog"])}(),function(t){try{t=angular.module("pipPictures.Templates")}catch(e){t=angular.module("pipPictures.Templates",[])}t.run(["$templateCache",function(e){e.put("add_image/add_image.html",'<md-menu><ng-transclude class="pip-add-image-open-button" ng-click="ngDisabled() ? \'\' : $mdOpenMenu()"></ng-transclude><md-menu-content width="4"><md-menu-item><md-button class="layout-row layout-align-start-center" accept="image/*" ng-keydown="onKeyDown($event)" ng-multiple="isMulti()" ng-file-select="" ng-file-change="onFileChange($files)" ng-click="hideMenu()" ng-file-drop=""><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:folder"></md-icon><span class="text-grey">{{::\'FILE\' | translate}}</span></md-button></md-menu-item><md-menu-item><md-button class="layout-row layout-align-start-center" ng-click="onWebLinkClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:weblink"></md-icon><span class="text-grey">{{::\'WEB_LINK\' | translate}}</span></md-button></md-menu-item><md-menu-item><md-button class="layout-row layout-align-start-center" ng-click="onCameraClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:camera"></md-icon><span class="text-grey">{{::\'CAMERA\' | translate}}</span></md-button></md-menu-item><md-menu-item><md-button class="layout-row layout-align-start-center" ng-click="onGalleryClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:images"></md-icon><span class="text-grey">{{::\'IMAGE_GALLERY\' | translate}}</span></md-button></md-menu-item></md-menu-content></md-menu>')}])}(),function(t){try{t=angular.module("pipPictures.Templates")}catch(e){t=angular.module("pipPictures.Templates",[])}t.run(["$templateCache",function(e){e.put("camera_dialog/camera_dialog.html",'<md-dialog class="pip-dialog pip-picture-dialog pip-camera-dialog layout-column" md-theme="{{theme}}" ng-show="browser != \'android\'" ng-class="{\'pip-android-dialog\': browser == \'android\' || !browser}"><div class="pip-header"><md-button ng-click="onCancelClick()" class="md-icon-button" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button><h3 class="m0 text-title">{{ ::\'TAKE_PICTURE\' | translate }}</h3></div><div class="pip-body"><div class="camera-stream" ng-hide="webCamError || browser == \'android\'"></div><div class="camera-error" ng-show="webCamError || browser == \'android\'"><span>{{ ::\'WEB_CAM_ERROR\' | translate }}</span></div></div><div class="pip-footer"><div class="w48"><md-button ng-click="onResetPicture()" ng-hide="!$freeze || webCamError" class="md-icon-button" ng-disabled="transaction.busy()" aria-label="{{ ::\'REMOVE_PICTURE\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:refresh"></md-icon></md-button></div><div class="flex"></div><div class="w48"><md-button ng-click="onTakePictureClick()" ng-hide="webCamError" class="md-icon-button" aria-label="{{ ::\'TAKE_PICTURE\' | translate }}"><md-icon class="text-grey icon-button" md-svg-icon="icons:{{$freeze ? \'check\' : \'camera\'}}"></md-icon></md-button></div><div class="flex"></div><div class="w48"><md-button ng-click="onCancelClick()" class="md-icon-button" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:cross"></md-icon></md-button></div></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipPictures.Templates")}catch(e){t=angular.module("pipPictures.Templates",[])}t.run(["$templateCache",function(e){e.put("gallery_search_dialog/gallery_search_dialog.html",'<md-dialog class="pip-dialog pip-gallery-search-dialog pip-picture-dialog layout-column" md-theme="{{theme}}"><md-progress-linear ng-show="transaction.busy()" md-mode="indeterminate"></md-progress-linear><md-dialog-content class="pip-body lp0 rp0 tp0 pip-scroll flex layout-row"><div class="layout-column layout-align-start-start flex"><div class="pip-header w-stretch layout-column layout-align-start-start"><h3 class="w-stretch text-title m0 bp8"><md-button class="md-icon-button m0" ng-click="onCancelClick()" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button>{{::\'IMAGE_GALLERY\' | translate}}</h3><div class="w-stretch divider-bottom layout-row layout-start-center"><input class="no-divider rm8 text-subhead1 flex" ng-disabled="transaction.busy()" ng-model="$search" ng-keypress="onKeyPress($event)" placeholder="{{::\'SEARCH_PICTURES\' | translate}}" type="text" tabindex="1"><md-button class="md-icon-button md-icon-button-square p0 pip-search-button md-primary" ng-click="onSearchClick()" ng-hide="optionDefault" tabindex="-1" aria-label="SEARCH"><md-icon class="text-opacity md-primary" md-svg-icon="icons:search-square"></md-icon></md-button></div></div><div class="pip-content flex" ng-show="$images.length > 0"><div class="pip-image-container" ng-click="onImageClick(image)" ng-repeat="image in $images track by $index" ng-class="{\'checked\': image.checked}" tabindex="{{ $index + 2 }}"><pip-picture pip-src="image.thumbnail" pip-default-icon="icon-images" pip-rebind="true"></pip-picture><div class="pip-checked-cover"></div><div class="pip-checkbox-backdrop"><md-checkbox md-no-ink="" ng-model="image.checked" ng-click="image.checked = !image.checked" aria-label="CHECKED"></md-checkbox></div></div></div><div class="pip-no-images w-stretch layout-column layout-align-center-center flex" ng-show="$images.length == 0"><img src="images/add_from_image_library.svg" width="200" height="200"><p class="text-secondary opacity-secondary text-center">{{\'IMAGE_START_SEARCH\' | translate}}</p></div></div></md-dialog-content><div class="pip-footer"><md-button ng-click="onCancelClick()" ng-hide="transaction.busy()" aria-label="{{ ::\'CANCEL\' | translate }}" tabindex="{{ $images.length + 3 }}"><span class="text-grey">{{ ::\'CANCEL\' | translate }}</span></md-button><md-button ng-if="transaction.busy()" ng-click="onStopSearchClick()" class="md-raised md-warn m0" tabindex="5" aria-label="ABORT" pip-test="button-cancel">{{::\'CANCEL\' | translate}}</md-button><md-button class="md-accent" ng-hide="transaction.busy()" ng-disabled="addButtonDisabled()" ng-click="onAddClick()" aria-label="{{ ::\'ADD\' | translate }}" tabindex="{{ $images.length + 4 }}">{{ ::\'ADD\' | translate }}</md-button></div></md-dialog>')}])}(),function(t){try{t=angular.module("pipPictures.Templates")}catch(e){t=angular.module("pipPictures.Templates",[])}t.run(["$templateCache",function(e){e.put("picture_edit/picture_edit.html",'<div class="pip-picture-upload pip-picture-drop md-focused" ng-keydown="onKeyDown($event)" tabindex="{{ ngDisabled() || control.uploading ? -1 : 0 }}" pip-changed="readItemLocally(url, file)" ng-disabled="ngDisabled()" pip-multi="false" ng-focus="onFocus()" ng-blur="onBlur()" pip-add-image=""><div class="pip-default-icon" ng-show="empty()"><md-icon class="pip-picture-icon" md-svg-icon="icons:{{icon}}"></md-icon></div><div class="pip-default-text" ng-show="empty()"><span>{{text | translate}}</span></div><img class="pip-picture-image" ng-src="{{control.url}}" ng-show="!empty()" ng-class="{ \'pip-image-new\': isUpdated(), \'cursor-default\' : ngDisabled() || control.uploading }" ui-event="{ error: \'onImageError($event)\', load: \'onImageLoad($event)\' }"><md-button class="md-icon-button" ng-click="onDeleteClick($event)" tabindex="-1" aria-label="delete" ng-hide="empty() || ngDisabled()" ng-disabled="ngDisabled() || control.uploading"><md-icon md-svg-icon="icons:cross"></md-icon></md-button><md-progress-linear ng-show="control.uploading" ng-value="control.progress"></md-progress-linear></div>')}])}(),function(t){try{t=angular.module("pipPictures.Templates")}catch(e){t=angular.module("pipPictures.Templates",[])}t.run(["$templateCache",function(e){e.put("picture_list_edit/picture_list_edit.html",'<div pip-focused=""><div class="pip-picture-upload pointer pip-focusable" ng-class="{\'pip-picture-error\': item.error}" ng-keydown="onKeyDown($event, item)" tabindex="{{ ngDisabled() ? -1 : 0 }}" ng-repeat="item in control.items | filter: filterItem"><div class="pip-default-icon" ng-hide="item.loaded || item.error"><md-icon pip-cancel-drag="true" class="pip-picture-icon" md-svg-icon="icons:{{icon}}"></md-icon></div><div class="pip-default-text" ng-show="item.error"><md-icon pip-cancel-drag="true" md-svg-icon="icons:warn-circle"></md-icon></div><img ng-src="{{::item.url}}" pip-cancel-drag="true" ng-hide="item.error" ng-class="{ \'pip-image-new\': item.state == \'added\' }" ui-event="{ error: \'onImageError($event, item)\', load: \'onImageLoad($event, item)\' }"><md-button ng-click="onDeleteClick(item)" ng-disabled="ngDisabled() || control.uploading" tabindex="-1" aria-label="delete" class="md-icon-button"><md-icon pip-cancel-drag="true" md-svg-icon="icons:cross"></md-icon></md-button><md-progress-linear md-mode="indeterminate" ng-show="item.uploading" value="{{ item.progress }}"></md-progress-linear></div><button class="pip-picture-upload pip-picture-drop pip-focusable" pip-add-image="" ng-focus="onFocus()" ng-blur="onBlur()" pip-changed="readItemLocally(url, file)" ng-disabled="ngDisabled() || control.uploading"><div class="pip-default-icon"><md-icon pip-cancel-drag="true" class="pip-picture-icon" md-svg-icon="icons:{{icon}}"></md-icon></div><div class="pip-default-text"><span>{{text | translate}}</span></div></button><div class="clearfix"></div></div>')}])}(),function(t){try{t=angular.module("pipPictures.Templates")}catch(e){t=angular.module("pipPictures.Templates",[])}t.run(["$templateCache",function(e){e.put("picture_url_dialog/picture_url_dialog.html",'<md-dialog class="pip-dialog pip-picture-url-dialog pip-picture-dialog layout-column" md-theme="{{theme}}"><md-dialog-content class="pip-body lp0 rp0 tp0 pip-scroll"><div class="pip-header bm16 layout-row layout-align-start-center"><md-button ng-click="onCancelClick()" class="md-icon-button lm0" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button><h3 class="text-title m0">{{ ::\'PICTURE_FROM_WEBLINK\' | translate}}</h3></div><div class="pip-content"><md-input-container md-no-float="" class="w-stretch text-subhead1"><input type="text" ng-model="url" ng-change="checkUrl()" placeholder="{{:: \'LINK_PICTURE\' | translate}}"></md-input-container><div class="w-stretch layout-row layout-align-center-center" ng-hide="invalid"><img id="url_image"></div><div class="pip-no-images layout-row layout-align-center-center" ng-show="invalid"><md-icon class="text-grey" md-svg-icon="icons:images"></md-icon></div></div></md-dialog-content><div class="pip-footer"><md-button ng-click="onCancelClick()" aria-label="{{ ::\'CANCEL\' | translate }}">{{ ::\'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-click="onAddClick()" ng-disabled="invalid" aria-label="{{ ::\'ADD\' | translate }}">{{ ::\'ADD\' | translate }}</md-button></div></md-dialog>')}])}(),function(){"use strict";var e=angular.module("pipAvatarEdit",["ui.event","angularFileUpload","pipPicturePaste","pipData","pipImageUtils","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{PICTURE_EDIT_TEXT:"Click here to upload a picture"}),e.translations("ru",{PICTURE_EDIT_TEXT:"Нажмите сюда для загрузки картинки"})}]),e.directive("pipAvatarEdit",function(){return{restrict:"EA",scope:{ngDisabled:"&",pipPartyId:"&",pipEntityType:"&",pipId:"&",pipCreated:"&",pipChanged:"&",pipReset:"&"},templateUrl:"picture_edit/picture_edit.html",controller:"pipAvatarEditController"}}),e.controller("pipAvatarEditController",["$scope","$element","$attrs","$http","$upload","$rootScope","pipPicturePaste","pipDataAvatar","pipImageUtils",function(o,e,t,i,l,n,a,r,d){var c=e.children(".pip-picture-upload"),u=c.children("input[type=file]");r.getEntityTypes();return o.text=t.pipDefaultText||"PICTURE_EDIT_TEXT",o.icon=t.pipDefaultIcon||"picture-no-border",o.control={url:"",progress:0,uploaded:!1,uploading:!1,loaded:!1,file:null,state:"original"},o.control.reset=function(e){if(o.control.progress=0,o.control.uploading=!1,o.control.uploaded=!1,o.control.file=null,o.control.state="original",o.control.url="",e)o.onChange();else{var t=r.getAvatarUrl({partyId:o.pipPartyId(),partyName:"",id:o.pipId(),type:o.pipEntityType(),noRedirect:!1,noDefault:!0});if(!t)return;o.control.progress=0,o.control.url=t,o.control.uploaded=""!=o.control.url,o.onChange()}},o.control.save=function(e,t){"changed"==o.control.state?function(t,i){var l=o.control,n=l.file;if(null!==o.control.file){var e=new FileReader;e.onload=function(e){l.uploading=!0;r.createAvatar({name:n.name,params:p(),type:n.type,data:e.target.result},function(e){l.reset(),t&&t(e)},function(e){l.uploading=!1,l.upload=!1,l.progress=0,i?i(e):console.error(e)},function(e){l.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},e.readAsArrayBuffer(n)}else l.uploading=!0,r.createAvatarByUrl(function(){var e=o.control.url,t=e.slice(e.lastIndexOf("/")+1,e.length).split("?")[0]+"&url="+e;return r.getAvatarPostUrl(p(),t)}(),function(e){l.reset(),t&&t(e)},function(e){l.uploading=!1,l.upload=!1,i?i(e):console.error(e)})}(e,t):"deleted"==o.control.state?function(t,i){var l=o.control;r.deleteDocument(p(),function(e){l.reset(!0),t&&t()},function(e){l.uploading=!1,l.upload=!1,l.progress=0,i?i(e):console.error(e)})}(e,t):e&&e()},o.empty=function(){return""==o.control.url&&!o.control.uploading},o.isUpdated=function(){return"original"!=o.control.state},o.readItemLocally=function(e,t){o.control.file=t,o.control.url=e,o.control.state="changed",o.onChange()},o.onDeleteClick=function(e){e.stopPropagation(),c.focus(),o.control.file=null,o.control.url="",o.control.state="deleted",o.onChange()},o.onKeyDown=function(e){13==e.keyCode||32==e.keyCode?setTimeout(function(){c.trigger("click")},0):46==e.keyCode||8==e.keyCode?(o.control.file=null,o.control.url="",o.control.state="deleted",o.onChange()):27==e.keyCode&&o.control.reset()},o.onImageError=function(t){o.$apply(function(){o.control.url="";var e=$(t.target);d.setErrorImageCSS(e,{width:"auto",height:"100%"})})},o.onImageLoad=function(e){var t=$(e.target);d.setImageMarginCSS({clientWidth:80,clientHeight:80},t),o.control.uploading=!1},o.onChange=function(){o.pipChanged&&o.pipChanged({$event:{sender:o.control},$control:o.control})},o.$watch(o.pipId,function(e){!1!==o.pipReset()&&o.control.reset()}),o.$watch(o.pipPartyId,function(e){!1!==o.pipReset()&&o.control.reset()}),o.$watch(o.ngDisabled,function(e){u.attr("disabled",o.control.disabled)}),e.children(".pip-picture-upload").focus(function(){a.addPasteListener(function(e){o.readItemLocally(e.url,e.file)})}),e.children(".pip-picture-upload").blur(function(){a.removePasteListener()}),e.addClass("pip-picture-edit"),o.pipCreated&&o.pipCreated({$event:{sender:o.control},$control:o.control}),void o.control.reset();function p(){return{entityType:o.pipEntityType(),id:o.pipId(),partyId:o.pipPartyId()}}}])}(),function(){"use strict";var e=angular.module("pipAddImage",["pipCameraDialog","pipPictureUrlDialog","pipGallerySearchDialog","pipCore"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{FILE:"Upload pictures",WEB_LINK:"Use web link",CAMERA:"Take photo",IMAGE_GALLERY:"Use image library"}),e.translations("ru",{FILE:"Загрузить картинку",WEB_LINK:"Вставить веб ссылка",CAMERA:"Использовать камеру",IMAGE_GALLERY:"Открыть галерею изображений"})}]),e.directive("pipAddImage",function(){return{restrict:"AC",scope:{$images:"=pipImages",onChange:"&pipChanged",multi:"&pipMulti",ngDisabled:"&"},transclude:!0,templateUrl:"add_image/add_image.html",controller:"pipAddImageController"}}),e.controller("pipAddImageController",["$scope","$element","$mdMenu","$timeout","pipCameraDialog","pipPictureUrlDialog","pipGallerySearchDialog","pipUtils",function(t,e,i,l,n,o,a,r){return t.hideMenu=function(){i.hide()},t.onFileChange=function(e){if(null==e||0==e.length)return;e.forEach(function(t){-1<t.type.indexOf("image")&&l(function(){var e=new FileReader;e.readAsDataURL(t),e.onload=function(e){l(function(){c({url:e.target.result,file:t})})}})})},t.onWebLinkClick=function(){o.show(function(e){var t=null;"data:image"==e.substring(0,10)&&((t=d(e)).name=e.slice(e.lastIndexOf("/")+1,e.length).split("?")[0]),c({url:e,file:t})})},t.onCameraClick=function(){n.show(function(e){var t=d(e);t.name="camera",c({url:e,file:t})})},t.onGalleryClick=function(){a.show(function(e){var t=[];e.forEach(function(e){t.push({url:e,file:null})}),c(t)},t.isMulti())},t.isMulti=function(){return void 0===t.multi()||r.toBoolean(t.multi())},void e.click(function(){t.ngDisabled()||$(e).find(".pip-add-image-open-button").scope().$mdOpenMenu()});function d(e){var t;t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],l=new Uint8Array(t.length),n=0;n<t.length;n++)l[n]=t.charCodeAt(n);return new Blob([l],{type:i})}function c(e){void 0!==e&&(Array.isArray(e)?e.forEach(function(e){t.onChange&&t.onChange({url:e.url,file:e.file})}):t.onChange&&t.onChange({url:e.url,file:e.file}),void 0!==t.$images&&Array.isArray(t.$images)&&(Array.isArray(e)?e.forEach(function(e){t.$images.push(e.url)}):t.$images.push(e.url)))}}])}(),function(){"use strict";var e=angular.module("pipAvatar",["pipCore","pipData","pipImageUtils"]);e.directive("pipAvatar",function(){return{restrict:"EA",scope:!1,template:'<md-icon></md-icon><img/><div><md-icon class="default_icon" id="icon-film" md-svg-icon="icons:film"></md-icon><md-icon class="default_icon" id="icon-task" md-svg-icon="icons:task"></md-icon><md-icon class="default_icon" id="icon-folder" md-svg-icon="icons:folder"></md-icon></div>',controller:"pipAvatarController"}}),e.controller("pipAvatarController",["$scope","$rootScope","$element","$attrs","$parse","pipUtils","pipDataAvatar","pipStrings","$http","pipImageUtils",function(d,e,c,t,i,l,u,p,n,o){var s=c.children("md-icon"),g=c.children("img"),f=c.children("div"),h=c.find("#icon-film"),m=c.find("#icon-task"),P=c.find("#icon-folder"),a=null,v=i(t.pipPartyId),y=i(t.pipPartyName),x=i(t.pipEntityType),b=i(t.pipId),C=i(t.pipImageUrl),w=u.getAvatarColors(),I=u.getColorClasses(),E=u.getEntityTypes();return g.load(function(e){a=$(e.target),o.setImageMarginCSS(c,a)}),c.addClass("pip-avatar flex-fixed"),t.ngClass&&d.$watch(t.ngClass,function(){setTimeout(function(){o.setImageMarginCSS(c,a)},50)}),r(),l.toBoolean(t.pipRebindAvatar)&&e.$on("pipPartyAvatarUpdated",function(){m.css("display","none"),h.css("display","none"),P.css("display","none"),f.css("display","none"),g.attr("src",""),s.css("display","none"),g.css("display","inline-block"),r()}),void(l.toBoolean(t.pipRebind)&&(d.$watch(v,function(e,t){t!==e&&r()}),d.$watch(b,function(e,t){t!==e&&r()}),d.$watch(C,function(e,t){t!==e&&r()})));function r(){var e=y(d),t=v(d),i=b(d),l=x(d),n=C(d);m.css("display","none"),h.css("display","none"),P.css("display","none"),f.css("display","none");var o={partyId:t,partyName:e,id:i,type:l,noRedirect:!1,noDefault:!1},a=n||u.getAvatarUrl(o);if(l&&i&&t||t&&e||n)if(l&&i&&t){if("category"==l)return;if("goals"==E[l]||"areas"==E[l])g.attr("src",a),s.css("display","none"),g.css("display","inline-block");else{f.css("display","block");var r=p.hashCode(i)%w.length;switch(c.addClass(I[r]),l){case"vision":s.css("display","none"),h.css("display","inline-block"),m.css("display","none"),P.css("display","none"),g.css("display","none");break;case"event":s.css("display","none"),m.css("display","inline-block"),h.css("display","none"),P.css("display","none"),g.css("display","none");break;case"note":s.css("display","none"),P.css("display","inline-block"),m.css("display","none"),h.css("display","none"),g.css("display","none")}}}else g.attr("src",a),s.css("display","none"),g.css("display","inline-block")}}])}(),function(){"use strict";var e=angular.module("pipCameraDialog",["ngMaterial","pipCore","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{TAKE_PICTURE:"Take a picture",WEB_CAM_ERROR:"Webcam is missing or was not found"}),e.translations("ru",{TAKE_PICTURE:"Сделать фото",WEB_CAM_ERROR:"Web-камера отсутствует или не найдена"})}]),e.factory("pipCameraDialog",["$mdDialog",function(e){return{show:function(t){e.show({templateUrl:"camera_dialog/camera_dialog.html",clickOutsideToClose:!0,controller:"pipCameraController"}).then(function(e){Webcam.reset(),t&&t(e)},function(){Webcam.reset()})}}}]),e.controller("pipCameraController",["$scope","$rootScope","$timeout","$mdMenu","$mdDialog","pipUtils",function(t,e,i,l,n,o){function a(e){var t="data:image/jpeg;base64,"+e;n.hide(t)}function r(e){alert("Failed because: "+e),n.hide()}return t.browser=o.getBrowser().os,t.theme=e.$theme,"android"!==t.browser?(Webcam.init(),setTimeout(function(){Webcam.attach(".camera-stream")},0),Webcam.on("error",function(e){t.webCamError=!0,console.error(e)}),Webcam.set({width:400,height:300,dest_width:400,dest_height:300,crop_width:400,crop_height:300,image_format:"jpeg",jpeg_quality:90}),Webcam.setSWFLocation("webcam.swf")):document.addEventListener("deviceready",function(){navigator.camera.getPicture(a,r,{sourceType:Camera.PictureSourceType.CAMERA,correctOrientation:!0,quality:75,targetWidth:200,destinationType:Camera.DestinationType.DATA_URL})},!1),t.$freeze=!1,t.onTakePictureClick=function(){Webcam&&(t.$freeze?Webcam.snap(function(e){t.$freeze=!1,n.hide(e)}):(t.$freeze=!0,Webcam.freeze()))},t.onResetPicture=function(){t.$freeze=!1,Webcam.unfreeze()},void(t.onCancelClick=function(){n.cancel()})}])}(),function(){"use strict";var e=angular.module("pipCollage",["pipCore","pipData"]);e.directive("pipCollage",function(){return{restrict:"EA",scope:!1,controller:"pipCollageController"}}),e.controller("pipCollageController",["$scope","$element","$attrs","$parse","$rootScope","pipUtils","pipStrings","pipImageUtils","pipDataPicture",function(n,a,e,t,i,l,o,r,d){var c=e.pipPictureIds?t(e.pipPictureIds):null,u=e.pipSrcs?t(e.pipSrcs):null,p=e.pipUniqueCode?t(e.pipUniqueCode):null,s=e.pipMultiple?t(e.pipMultiple):null,g=l.toBoolean(e.pipOpen),f=r.getCollageSchemes(),h='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1"xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink"x="0px" y="0px"viewBox="0 0 510 510"style="enable-background:new 0 0 515 515;"xml:space="preserve"><defs><style type="text/css"><![CDATA[#symbol-picture-no-border {        transform-origin: 50% 50%;        transform: scale(0.6, -0.6);    }        ]]></style>        </defs><rect x="0" width="515" height="515"/><path id="symbol-picture-no-border" d="M120 325l136-102 69 33 136-82 0-54-410 0 0 136z m341 15c0-28-23-51-51-51-29 0-52 23-52 51 0 29 23 52 52 52 28 0 51-23 51-52z" /></svg>';a.addClass("pip-collage"),l.toBoolean(e.pipRebind)&&(u?(n.$watch(u,function(e){b()}),n.$watchCollection(u,function(e){b()})):c&&n.$watch(c,function(e){b()})),n.getElementDimensions=function(){return{h:a.height(),w:a.width()}};_.debounce(m,50);function m(){for(var e=a.find("img"),t=0;t<e.length;t++){var i=angular.element(e[t].parentElement),l=angular.element(e[t]);"none"!=l.css("display")&&r.setImageMarginCSS(i,l)}var n=a.find("md-icon");for(t=0;t<n.length;t++){i=angular.element(n[t].parentElement);var o=angular.element(n[t]);"none"!=i.css("display")&&r.setIconMarginCSS(i[0],o)}}return n.$watch(n.getElementDimensions,function(e,t){e&&t&&t.h==e.h&&t.w==e.w||m()},!0),void b();function P(e){var t=$(e.target),i=t.parent(),l=i.children("div"),n=t.parent().find("md-icon");l.css("display","block"),t.css("display","none"),r.setIconMarginCSS(i[0],n),n.empty().append(h)}function v(e){var t=$(e.target),i=t.parent(),l=i.children("div");r.setImageMarginCSS(i,t),l.css("display","none")}function y(e){var t=f[e-1];if(1==t.length)return t[0];var i=p?""+p(n):"";return t[o.hashCode(i)%t.length]}function x(e,t){return t.group?function(e,t){var i,l="";l+=t.fullWidth?" pip-full-width":"",l+=t.fullHeight?" pip-full-height":"",l+=" flex-"+t.flex,i='<div class="pip-picture-group layout'+(l+=" layout-"+t.layout)+'" flex="'+t.flex+'" layout="'+t.layout+'">';for(var n=0;n<t.children.length;n++)i+=x(e,t.children[n]);return i+="</div>"}(e,t):function(e,t){var i=e[0],l="",n="";return e.splice(0,1),l+=t.fullWidth?" pip-full-width":"",l+=t.fullHeight?" pip-full-height":"",l+=" flex-"+t.flex,n+=t.leftPadding?" pip-left":"",n+=t.rightPadding?" pip-right":"",n+=t.topPadding?" pip-top":"",n+=t.bottomPadding?" pip-bottom":"",g?'<a class="pip-picture-container'+l+'" flex="'+t.flex+'" href="'+i+'"  target="_blank"><div class="pip-picture'+n+'"><img src="'+i+'"/><div><md-icon></md-icon></div></div></a>':'<div class="pip-picture-container'+l+'" flex="'+t.flex+'"><div class="pip-picture'+n+'"><img src="'+i+'"/><div><md-icon></md-icon></div></div></div>'}(e,t)}function b(e){if(a.find("img").unbind("error").unbind("load"),a.empty(),0!=(e=function(){if(u){var e=u(n);return _.clone(e)}if(c){for(var t=c(n)||[],i=[],l=0;l<t.length;l++)i.push(d.getPictureContentUrl(t[l]));return i}return[]}()).length){if(8<e.length)!!s&&s(n)||(e.length=8);if(e.length<=8){var t='<div class="pip-collage-section">'+x(e,y(e.length))+"</div>";t+='<div class="clearfix"></div>',a.html(t)}else{for(t="";0<e.length;){var i=e.splice(0,8);t+='<div class="pip-collage-section">'+x(i,y(i.length))+"</div>"}t+='<div class="clearfix"></div>',a.html(t)}a.find("img").bind("error",P).bind("load",v),a.show()}else a.hide()}}])}(),function(){"use strict";var e=angular.module("pipGallerySearchDialog",["ngMaterial","pipCore","pipPictures.Templates","pipRest"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{IMAGE_GALLERY:"Add from image gallery",SEARCH_PICTURES:"Search for pictures...",IMAGE_START_SEARCH:"Images will appear here once you start searching"}),e.translations("ru",{IMAGE_GALLERY:"Добавить из галереи изображений",SEARCH_PICTURES:"Поиск изображений...",IMAGE_START_SEARCH:"Картинки появятся после начала поиска"})}]),e.factory("pipGallerySearchDialog",["$mdDialog",function(i){return{show:function(t,e){i.show({templateUrl:"gallery_search_dialog/gallery_search_dialog.html",clickOutsideToClose:!0,controller:"pipGallerySearchController",locals:{multiple:e}}).then(function(e){t&&t(e)},function(){})}}}]),e.controller("pipGallerySearchController",["$scope","$rootScope","$timeout","$mdMenu","$mdDialog","$http","pipRest","multiple","pipTransaction",function(l,e,t,i,n,o,a,r,d){var c="",u=a.serverUrl()+"/api/images/search",p=[];return l.theme=e.$theme,l.$serverUrl=a.serverUrl(),l.$search="",l.$images=[],l.transaction=d("search",l),l.onSearchClick=function(){if(l.transaction.busy())return;if(""==l.$search||l.$search==c)return;c=l.$search,l.$images=[],l.stop=null;var e=u+"?q="+l.$search,i=l.transaction.begin("ENTERING");if(!i)return;o.get(e).success(function(e){if(!l.transaction.aborted(i)){for(var t=0;t<e.length;t++)l.$images.push({checked:!1,url:e[t].link,thumbnail:e[t].thumbnail});l.transaction.end()}}).error(function(e){console.error(e)})},l.onKeyPress=function(e){13===e.keyCode&&l.onSearchClick()},l.onImageClick=function(e){if(l.transaction.busy())return;e.checked=!e.checked,r?e.checked?p.push(e):_.remove(p,{url:e.url}):e.checked?0<p.length?(p[0].checked=!1,p[0]=e):p.push(e):p=[]},l.onAddClick=function(){if(l.transaction.busy())return;var t=[];p.forEach(function(e){e.checked&&t.push(e.url)}),n.hide(t)},l.onCancelClick=function(){n.cancel()},l.addButtonDisabled=function(){return 0==p.length||l.transaction.busy()},l.onStopSearchClick=function(){l.transaction.abort(),c=""},void setTimeout(function(){var e=$(".pip-gallery-search-dialog .search-images");0<e.length&&e.focus()},0)}])}(),function(){"use strict";var e=angular.module("pipPicture",["pipCore","pipData"]);e.directive("pipPicture",function(){return{restrict:"EA",scope:{src:"&pipSrc",pictureId:"=pipPictureId",defaultIcon:"=pipDefaultIcon"},template:"<img ui-event=\"{ error: 'onImageError($event)', load: 'onImageLoad($event)' }\"/><div><span></span></div>",controller:"pipPictureController"}}),e.controller("pipPictureController",["$scope","$element","$attrs","$rootScope","pipUtils","pipImageUtils","pipDataPicture",function(i,l,e,t,n,o,a){var r=l.children("img"),d=l.children("div");return i.onImageError=function(t){i.$apply(function(){var e=$(t.target);o.setErrorImageCSS(e),d.css("display","block")})},i.onImageLoad=function(e){var t=$(e.target);o.setImageMarginCSS(l,t),d.css("display","none")},l.addClass("pip-picture"),c(),n.toBoolean(e.pipRebind)&&i.$watch(i.pictureId,function(e){i.pictureId!=e&&c()}),void(n.toBoolean(e.pipRebind)&&i.$watch(i.src,function(e){i.src!=e&&c()}));function c(){if(i.pictureId){var e=pipDatPicture.getPictureContentUrl(i.pictureId);r.attr("src",e)}else i.src?r.attr("src",i.src()):r.attr("src","")}}])}(),function(){"use strict";var e=angular.module("pipPictureEdit",["ui.event","angularFileUpload","pipData","pipPicturePaste","pipTranslate","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{ERROR_WRONG_IMAGE_FILE:"Incorrect image file. Please, choose another one",PICTURE_EDIT_TEXT:"Click here to upload a picture"}),e.translations("ru",{ERROR_WRONG_IMAGE_FILE:"Неправильный файл с изображением. Выберете другой файл",PICTURE_EDIT_TEXT:"Нажмите сюда для загрузки картинки"})}]),e.directive("pipPictureEdit",function(){return{restrict:"EA",scope:{ngDisabled:"&",pipCreated:"&",pipChanged:"&",pipReset:"&",pipPictureId:"=",pipPartyId:"=",pipAddedPicture:"="},templateUrl:"picture_edit/picture_edit.html",controller:"pipPictureEditController"}}),e.controller("pipPictureEditController",["$scope","$element","$attrs","$http","$upload","$timeout","$rootScope","$parse","pipDataPicture","pipPicturePaste","pipImageUtils","pipUtils","pipDataAvatar",function(a,e,t,i,l,n,o,r,d,c,u,p,s){var g=e.children(".pip-picture-upload"),f=g.children("input[type=file]");return a.text=t.pipDefaultText||"PICTURE_EDIT_TEXT",a.icon=t.pipDefaultIcon||"picture-no-border",a.pictureStartState=p.toBoolean(a.pipAddedPicture)?"copied":"original",a.control={url:"",progress:0,uploaded:!1,uploading:!1,loaded:!1,file:null,state:a.pictureStartState},a.control.reset=function(e){a.control.progress=0,a.control.uploading=!1,a.control.uploaded=!1,a.control.file=null,a.control.state=a.pictureStartState;var t=a.control.url="";if(e)a.onChange();else{if(o.$party&&o.$party.id&&a.pipPictureId&&(t=d.getPictureContentUrl(a.pipPictureId)),!t)return;a.control.url=t,a.control.uploaded=!0,a.onChange()}},a.control.save=function(e,t){"changed"==a.control.state?function(t,i){var l=a.control,n=l.file;if(null!==a.control.file){var e=new FileReader;e.onload=function(e){l.uploading=!0;d.createPicture({name:n.name,type:n.type,data:e.target.result},function(e){a.pipPictureId=e.data.id,l.reset(),t&&t(e)},function(){l.uploading=!1,l.upload=!1,l.progress=0,i?i(error):console.error(error)},function(e){item.progress=Math.min(100,parseInt(100*e.loaded/e.total))})},e.readAsArrayBuffer(n)}else{var o=a.control.url.slice(item.url.lastIndexOf("/")+1,a.control.url.length).split("?")[0]+"&url="+a.control.url;l.uploading=!0,s.createAvatarByUrl(pipDatPicture.getPicturePostUrl(o),function(e){a.pipPictureId=e.id,l.reset(),t&&t(e)},function(e){l.uploading=!1,l.upload=!1,i?i(e):console.error(e)})}}(e,t):"deleted"==a.control.state?function(e,t){var i=a.control;d.deletePicture(a.pipPictureId,function(){a.pipPictureId=null,i.reset(!0),e&&e()},function(e){i.uploading=!1,i.upload=!1,i.progress=0,t?t(e):console.error(e)})}(e,t):e&&e()},a.empty=function(){return""==a.control.url&&!a.control.uploading},a.isUpdated=function(){return"original"!=a.control.state},a.readItemLocally=function(e,t){a.control.file=t,a.control.url=e,a.control.state="changed",a.onChange()},a.onDeleteClick=function(e){e.stopPropagation(),g.focus(),a.control.file=null,a.control.url="","copied"!=a.control.state&&(a.control.state="deleted");a.onChange()},a.onKeyDown=function(e){13==e.keyCode||32==e.keyCode?setTimeout(function(){g.trigger("click")},0):46==e.keyCode||8==e.keyCode?(a.control.file=null,a.control.url="",a.control.state="deleted",a.onChange()):27==e.keyCode&&a.control.reset()},a.onImageError=function(t){a.$apply(function(){a.control.url="";var e=$(t.target);u.setErrorImageCSS(e,{width:"auto",height:"100%"})})},a.onImageLoad=function(e){var t=$(e.target);u.setImageMarginCSS({clientWidth:80,clientHeight:80},t),a.control.uploading=!1},a.onChange=function(){a.pipChanged&&a.pipChanged({$event:{sender:a.control},$control:a.control})},a.onBlur=function(){c.removePasteListener()},a.onFocus=function(){c.addPasteListener(function(e){a.readItemLocally(e.url,e.file)})},p.toBoolean(t.pipRebind)&&a.$watch("pipPictureId",function(e){a.control.reset()}),a.$watch(a.ngDisabled,function(e){f.attr("disabled",a.control.disabled)}),e.addClass("pip-picture-edit"),a.control.reset(),void(a.pipCreated&&a.pipCreated({$event:{sender:a.control},$control:a.control}))}])}(),function(){"use strict";var e=angular.module("pipPictureListEdit",["ui.event","angularFileUpload","pipCore","pipFocused","pipData","pipPicturePaste"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{PICTURE_LIST_EDIT_TEXT:"Click here to add a picture",ERROR_TRANSACTION_IN_PROGRESS:"Transaction is in progress. Please, wait until it is finished or abort",ERROR_IMAGE_PRELOADING:"Image loading error. The picture can not be saved"}),e.translations("ru",{PICTURE_LIST_EDIT_TEXT:"Нажмите сюда чтобы добавить картинку",ERROR_TRANSACTION_IN_PROGRESS:"Транзакция еще не завершена. Подождите окончания или прервите её",ERROR_IMAGE_PRELOADING:"Ошибка при загрузки картинки. Картинка не сохранена."})}]),e.directive("pipPictureListEdit",function(){return{restrict:"EA",scope:{pipPictureIds:"=",pipAddedPicture:"=",ngDisabled:"&",pipCreated:"&",pipChanged:"&"},templateUrl:"picture_list_edit/picture_list_edit.html",controller:"pipPictureListEditController"}}),e.controller("pipPictureListEditController",["$scope","$rootScope","$element","$attrs","$parse","$http","$upload","$timeout","pipUtils","pipDataPicture","pipPicturePaste","pipImageUtils","pipDataAvatar",function(a,e,t,i,l,n,o,r,d,c,u,p,s){var g=t.children(".pip-picture-drop"),f=0;return a.text=i.pipDefaultText||"PICTURE_LIST_EDIT_TEXT",a.icon=i.pipDefaultIcon||"picture-no-border",a.pipRebind=d.toBoolean(i.pipRebind),a.pictureStartState=d.toBoolean(a.pipAddedPicture)?"copied":"original",a.control={uploading:0,items:[]},a.control.reset=function(){a.control.uploading=0,a.control.items=function(){var e=a.pipPictureIds,t=[];if(null==e||0==e.length)return t;for(var i=0;i<e.length;i++)t.push({pin:f++,id:e[i],uploading:!1,uploaded:!1,progress:0,file:null,url:h(e[i]),state:a.pictureStartState});return t}()},a.control.save=function(t,i){var l=a.control;if(l.uploading)return void(i&&i("ERROR_TRANSACTION_IN_PROGRESS"));l.error=null,l.uploading=0;for(var e=function(e){e&&!l.error&&(l.error=e),l.uploading--,0==l.uploading&&(l.error?i?i(l.error):console.error(l.error):(function(){a.pipPictureIds&&0<a.pipPictureIds.length&&a.pipPictureIds.splice(0,a.pipPictureIds.length);for(var e=0;e<a.control.items.length;e++){var t=a.control.items[e];t.id&&a.pipPictureIds.push(t.id)}}(),t&&t()))},n=0;n<l.items.length;n++){var o=l.items[n];"added"!=o.state||o.error?"deleted"==o.state&&(l.uploading++,P(o,e)):(l.uploading++,m(o,e))}0==l.uploading&&t&&t()},a.control.abort=function(){for(var e=a.control,t=0;t<e.items.length;t++){var i=e.items[t];i.uploading&&(i.upload&&i.upload.abort(),i.uploaded=!1,i.uploading=!1,i.progress=0,i.upload=null)}e.uploading=0},a.filterItem=function(e){return"deleted"!=e.state},a.readItemLocally=v,a.onSelectClick=function(e){if(g.focus(),null==e||0==e.length)return;for(var t=0;t<e.length;t++){var i=e[t];-1<i.type.indexOf("image")&&v(i)}},a.onDeleteClick=function(e){"added"==e.state||"copied"==e.state?_.remove(a.control.items,{pin:e.pin}):e.state="deleted";a.onChange()},a.onKeyDown=function(e,t){t?46!=e.keyCode&&8!=e.keyCode||("added"==t.state?_.remove(a.control.items,{pin:t.pin}):t.state="deleted",a.onChange()):13!=e.keyCode&&32!=e.keyCode||setTimeout(function(){g.trigger("click")},0)},a.onImageError=function(e,t){t.error=!0},a.onImageLoad=function(t,e){e.error=!1,setTimeout(function(){var e=$(t.target);p.setImageMarginCSS({clientWidth:80,clientHeight:80},e)},250),e.loaded=!0},a.onChange=function(){a.pipChanged&&a.pipChanged({$event:{sender:a.control},$control:a.control})},a.onBlur=function(){u.removePasteListener()},a.onFocus=function(e){u.addPasteListener(function(e){a.readItemLocally(e.url,e.file)})},a.pipRebind&&a.$watch(function(){return a.pipPictureIds},function(e){a.control.reset()}),t.addClass("pip-picture-list-edit"),a.control.reset(),void(a.pipCreated&&a.pipCreated({$event:{sender:a.control},$control:a.control}));function h(e){return c.getPictureContentUrl(e)}function m(t,i){if(null!==t.file){var e=t.file,l=new FileReader;l.onload=function(e){t.uploading||(t.uploading=!0,t.upload=c.createPicture({name:t.file.name,type:t.file.type,data:e.target.result},function(e){t.id=e.data?e.data.id:null,t.uploaded=!0,t.uploading=!1,t.progress=0,t.upload=null,t.file=null,t.url=h(t.id),t.state="original",i()},function(){t.uploaded=!1,t.uploading=!1,t.progress=0,t.upload=null,i(error)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total))}))},l.readAsArrayBuffer(e)}else{var n=t.url.slice(t.url.lastIndexOf("/")+1,t.url.length).split("?")[0]+"&url="+t.url;t.uploading=!0,s.createAvatarByUrl(c.getPicturePostUrl(n),function(e){t.id=e.data?e.data.id:e.id||null,t.uploaded=!0,t.uploading=!1,t.progress=0,t.upload=null,t.file=null,t.url=h(t.id),t.state="original",i()},function(e){t.uploaded=!1,t.uploading=!1,t.progress=0,t.upload=null,i()})}}function P(t,i){var l=a.control;t.upload&&(t.upload.abort(),t.upload=null),"deleted"==t.state&&c.deletePicture(t.id,function(){_.remove(l.items,{pin:t.pin}),i()},function(e){null==e?_.remove(l.items,{pin:t.pin}):(t.uploaded=!1,t.uploading=!1,t.progress=0,t.upload=null),i(e)})}function v(e,t){a.control.items.push({pin:f++,id:null,uploading:!1,uploaded:!1,progress:0,file:t,url:e,state:"added"}),a.onChange()}}])}(),function(){"use strict";var e=angular.module("pipPictureUrlDialog",["ngMaterial","pipCore","pipPictures.Templates"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{PICTURE_FROM_WEBLINK:"Add from web link",LINK_PICTURE:"Link to the picture..."}),e.translations("ru",{PICTURE_FROM_WEBLINK:"Добавить из веб ссылки",LINK_PICTURE:"Ссылка на изображение..."})}]),e.factory("pipPictureUrlDialog",["$mdDialog",function(e){return{show:function(t){e.show({templateUrl:"picture_url_dialog/picture_url_dialog.html",clickOutsideToClose:!0,controller:"pipPictureUrlDialogController"}).then(function(e){t&&t(e)})}}}]),e.controller("pipPictureUrlDialogController",["$scope","$rootScope","$timeout","$mdMenu","$mdDialog","pipImageUtils",function(t,e,i,l,n,o){return t.url="",t.invalid=!0,t.theme=e.$theme,t.checkUrl=function(){var e=$("img#url_image").on("error",function(){t.invalid=!0,t.$apply()}).on("load",function(){t.invalid=!1,function(e){var t=e.width(),i=e.height(),l={};i<t?(l.width="250px",l.height="auto"):(l.width="auto",l.height="250px");e.css(l)}(e),t.$apply()}).attr("src",t.url)},t.onCancelClick=function(){n.cancel()},void(t.onAddClick=function(){n.hide(t.url)})}])}(),function(){"use strict";angular.module("pipPicturePaste",[]).factory("pipPicturePaste",["$timeout",function(n){var e={},t=null;return e.addPasteListener=function(l){window.Clipboard||(null!==t&&this.removePasteElement(),(t=document.createElement("div")).setAttribute("contenteditable","true"),$(t).css({position:"absolute",left:"-999",width:"0",height:"0",overflow:"hidden",outline:0}),document.body.appendChild(t)),$(document).on("paste",function(e){if(null==e.clipboardData&&e.originalEvent&&(e=e.originalEvent),e.clipboardData){var t=e.clipboardData.items;_.each(t,function(e){if(-1!=e.type.indexOf("image")){var t=e.getAsFile(),i=new FileReader;i.onload=function(e){n(function(){l({url:e.target.result,file:t})})},i.readAsDataURL(t)}})}else window.clipboardData&&window.clipboardData.files&&_.each(window.clipboardData.files,function(t){var e=new FileReader;e.onload=function(e){n(function(){l({url:e.target.result,file:t})})},e.readAsDataURL(t)})})},e.removePasteListener=function(){window.Clipboard||null!==t&&(document.body.removeChild(t),t=null),$(document).off("paste")},e}])}(),function(){"use strict";angular.module("pipImageUtils",[]).service("pipImageUtils",["$http","pipStrings","$rootScope","pipRest",function(e,t,i,l){var n=[[{flex:100,fullWidth:!0,fullHeight:!0}],[{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullHeight:!0,rightPadding:!0},{flex:50,fullHeight:!0,leftPadding:!0}]}],[{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullHeight:!0,rightPadding:!0},{flex:33,fullHeight:!0,leftPadding:!0,rightPadding:!0},{flex:33,fullHeight:!0,leftPadding:!0}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullHeight:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{flex:50,leftPadding:!0,bottomPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:70,fullHeight:!0,rightPadding:!0},{group:!0,layout:"column",flex:30,fullHeight:!0,children:[{flex:50,leftPadding:!0,bottomPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,rightPadding:!0,topPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:30,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:70,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:100,fullWidth:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:67,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:100,fullWidth:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:67,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:75,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,fullWidth:!0,children:[{group:!0,layout:"row",flex:50,fullWidth:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullWidth:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]];return{setErrorImageCSS:function(e,t){var i={width:"","margin-left":"",height:"","margin-top":""};t&&(i=_.assign(i,t));e&&e.css(i)},setImageMarginCSS:function(e,t,i){var l=e.width?e.width():e.clientWidth,n=e.height?e.height():e.clientHeight,o=t[0].naturalWidth||t.width,a=t[0].naturalHeight||t.height,r=0,d={};a/n<o/l?(r=-(o/a*n-l)/2,d["margin-left"]=r+"px",d.height=n+"px",d.width=o*n/a+"px",d["margin-top"]=""):(r=-(a/o*l-n)/2,d["margin-top"]=r+"px",d.height=a*l/o+"px",d.width=l+"px",d["margin-left"]="");i&&(d=_.assign(d,i));t.css(d)},setIconMarginCSS:function(e,t){var i=e.clientWidth?e.clientWidth:e.width,l=e.clientHeight?e.clientHeight:e.height,n=0,o=l<i?l:i,a={width:o+"px","margin-left":"",height:o+"px","margin-top":""};l<i?(n=(i-l)/2,a["margin-left"]=n+"px"):(n=(l-i)/2,a["margin-top"]=n+"px");t.css(a)},getCollageSchemes:function(){return n}}}])}();